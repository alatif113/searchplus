define(["underscore","jquery","splunkjs/mvc/simplesplunkview","/static/app/searchplus/js/format.min.js","/static/app/searchplus/js/searchplus_icons.min.js"],(function(t,s,a,e){return a.extend({className:"spview",options:{data:"preview",outputMode:"json"},createView:function(){return this},formatData:function(s){let a=this.resultsModel.data().fields;return t.map(s,(function(s){return t.object(a,s)}))},updateView:function(t,a){t.$el.html(""),a.forEach((function(a){var n="/app/"+a.app+"/search?q="+(/^\s*\|/.test(a.search)?"":"search%20")+encodeURIComponent(a.search)+"&earliest="+(a.earliest||"-24h")+"&latest="+(a.latest||"now"),i="/manager/searchplus/saved/searches?app="+a.app+"&count=10&offset=0&itemType=&owner="+a.owner+"&search=%22"+encodeURIComponent(a.title)+"%22",c=s(`\n\t\t\t\t<div class="sp-search-row">\n\t\t\t\t\t<div class="sp-search sp-clickable sp-flex-container">\n\t\t\t\t\t\t<div class="sp-search-col sp-search-dropdown sp-flex-container">\n\t\t\t\t\t\t\t<svg class="sp-icon" width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t\t<path d="M9 6L15 12L9 18" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-search-col sp-search-label">${a.title}</div>\n\t\t\t\t\t\t<div class="sp-search-col sp-search-app">${a.app}</div>\n\t\t\t\t\t\t<div class="sp-search-col sp-search-owner">${a.owner}</div>\n\t\t\t\t\t\t<div class="sp-search-col sp-search-updated">${a.updated}</div>\n\t\t\t\t\t\t<div class="sp-search-col sp-search-updated">${a.next_scheduled_time}</div>\n\t\t\t\t\t\t<div class="sp-search-col sp-search-updated">${a.sharing}</div>\n\t\t\t\t\t\t<div class="sp-search-col sp-search-status"><span class="sp-search-status-${a.status}">${a.status}</span></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="sp-search-details">\n\t\t\t\t\t\t<div class="sp-search-details-nav sp-flex-container">\n\t\t\t\t\t\t\t<div class="sp-nav-item sp-clickable selected" data-attr-section="general">General</div>\n\t\t\t\t\t\t\t<div class="sp-nav-item sp-clickable" data-attr-section="attributes">Attributes</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-nav-section sp-nav-section-general sp-flex-container" data-attr-section="general">\n\t\t\t\t\t\t\t<div class="sp-query-container sp-card">\n\t\t\t\t\t\t\t\t<div class="sp-query-overflow">\n\t\t\t\t\t\t\t\t\t<div class="sp-search-query">${e(a.search,!0,!0)}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="sp-query-controls-container sp-flex-container">\n\t\t\t\t\t\t\t\t\t<a href="${n}" target="_blank" class="sp-query-control sp-query-control-search sp-flex-container">${icon_search}<span>Search</span></a>\n\t\t\t\t\t\t\t\t\t<a class="sp-query-control sp-query-control-copy sp-flex-container">${icon_copy}<span>Copy</span></a>\n\t\t\t\t\t\t\t\t\t<a href="${i}" target="_blank" class="sp-query-control sp-query-control-edit sp-flex-container">${icon_edit}<span>Edit</span></a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="sp-search-desc">\n\t\t\t\t\t\t\t\t<div class="sp-search-timing">\n\t\t\t\t\t\t\t\t\t<span><span class="sp-bold">Timespan:</span><span class="sp-mono"> ${a.earliest||"N/A"} - ${a.latest||"N/A"}</span></span>\n\t\t\t\t\t\t\t\t\t<span><span class="sp-bold">Schedule:</span><span class="sp-mono"> ${a.cron_schedule||"Not Scheduled"}</span></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="sp-search-desc-text">\n\t\t\t\t\t\t\t\t\t<div class="sp-search-desc-value">${a.description||"No description."}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-nav-section sp-nav-section-attributes sp-flex-container" data-attr-section="attributes" style="display: none;">\n\t\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t\t<div class="sp-attribute-label">${icon_commands}<span>Commands</span></div>\n\t\t\t\t\t\t\t\t<div class="sp-attribute sp-attribute-1">${t._makeAttrMarkup(a.command)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t\t<div class="sp-attribute-label">${icon_datamodels}<span>Datamodels</span></div>\n\t\t\t\t\t\t\t\t<div class="sp-attribute sp-attribute-2">${t._makeAttrMarkup(a.datamodel)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t\t<div class="sp-attribute-label">${icon_fields}<span>Fields</span></div>\n\t\t\t\t\t\t\t\t<div class="sp-attribute sp-attribute-3">${t._makeAttrMarkup(a.field)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t\t<div class="sp-attribute-label">${icon_functions}<span>Functions</span></div>\n\t\t\t\t\t\t\t\t<div class="sp-attribute sp-attribute-4">${t._makeAttrMarkup(a.function)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t\t<div class="sp-attribute-label">${icon_indexes}<span>Indexes</span></div>\n\t\t\t\t\t\t\t\t<div class="sp-attribute sp-attribute-5">${t._makeAttrMarkup(a.index)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t\t<div class="sp-attribute-label">${icon_lookups}<span>Lookups</span></div>\n\t\t\t\t\t\t\t\t<div class="sp-attribute sp-attribute-6">${t._makeAttrMarkup(a.lookup)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t\t<div class="sp-attribute-label">${icon_macros}<span>Macros</span></div>\n\t\t\t\t\t\t\t\t<div class="sp-attribute sp-attribute-7">${t._makeAttrMarkup(a.macro)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t`);"yes"==a.correlation_search&&(s(".sp-search-details-nav",c).append('\n\t\t\t\t\t\t<div class="sp-nav-item sp-clickable" data-attr-section="correlation">Correlation Search</div>\n\t\t\t\t\t'),s(".sp-search-details",c).append(`\n\t\t\t\t\t<div class="sp-nav-section sp-nav-section-correlation sp-flex-container" data-attr-section="correlation" style="display: none;">\n\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t<dl class="sp-list-dotted"><dt class="sp-bold">Security Domain:</dt><dd> ${a.security_domain||"N/A"}</dd></dl>\n\t\t\t\t\t\t\t<dl class="sp-list-dotted"><dt class="sp-bold">Severity:</dt><dd class="sp-severity sp-severity-${a.severity||"na"}"> ${a.severity||"N/A"}</dd></dl>\n\t\t\t\t\t\t\t<dl class="sp-list-dotted"><dt class="sp-bold">Risk Analysis:</dt><dd> ${a.risk||"N/A"}</dd></dl>\n\t\t\t\t\t\t\t<dl class="sp-list-dotted"><dt class="sp-bold">Notable Event:</dt><dd> ${a.notable||"N/A"}</dd></dl>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t<div class="sp-attribute-label">${icon_tactics}<span>MITRE ATT&CK Tactics</span></div>\n\t\t\t\t\t\t\t<div class="sp-attribute sp-attribute-1">${t._makeAttrMarkup(a.mtr_tactic)}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-attribute-container">\n\t\t\t\t\t\t\t<div class="sp-attribute-label">${icon_techniques}<span>MITRE ATT&CK Techniques</span></div>\n\t\t\t\t\t\t\t<div class="sp-attribute sp-attribute-2">${t._makeAttrMarkup(a.mtr_technique)}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t`)),s(".sp-search",c).on("click",(function(){$parent=s(this).parent(),s(".sp-search-row.selected").not($parent).removeClass("selected"),$parent.toggleClass("selected")})),s(".sp-nav-item",c).on("click",(function(){if(s(this).hasClass("selected"))return;let t=s(this).closest(".sp-search-details");s(".sp-nav-item.selected",t).removeClass("selected"),s(this).addClass("selected");let a=s(this).attr("data-attr-section");console.log(a),s(".sp-nav-section",t).not(`[data-attr-section="${a}"]`).hide(),s(`.sp-nav-section[data-attr-section="${a}"]`,t).show()})),s(".sp-query-control-copy",c).on("click",(function(){let t=s(".sp-search-query",s(this).closest(".sp-query-container")).text(),a=s(this);navigator.clipboard.writeText(t).then((function(){a.addClass("animate-copied").html(`${icon_check} <span>Copy</span>`).delay(1e3).queue((function(){a.removeClass("animate-copied").html(`${icon_copy} <span>Copy</span>`).dequeue()}))}),(function(){}))})),t.$el.append(c)}))},_makeAttrMarkup:function(t,s=null){if(!t)return"";Array.isArray(t)||(t=[t]);let a="";return t.forEach((t=>{"N/A"!=t&&""!=t&&(a+=`<span class="sp-tag" title="${t}">${t}</span>`)})),a}})}));