require(["jquery","splunkjs/mvc","splunkjs/mvc/searchmanager","splunkjs/mvc/postprocessmanager","splunkjs/mvc/simpleform/input/text","splunkjs/mvc/simpleform/input/multiselect","splunkjs/mvc/timerangeview","splunkjs/mvc/dropdownview","/static/app/searchplus/js/searchplus_view.min.js","/static/app/searchplus/js/searchplus_icons.min.js"],(function(t,e,s,n,a,i,l,p,c){$dashboard=t(".dashboard-body").html(`\n\t\t<div class="sp-view sp-flex-container">\n\t\t\t<div class="sp-filter-container">\n\t\t\t\t<div class="sp-result-count sp-flex-container">${icon_filter}<span class="sp-result-count-value">0</span> Matched Searches</div>\n\t\t\t\t<div class="sp-filter">\n\t\t\t\t\t<div class="sp-input-group">\n\t\t\t\t\t\t<div class="sp-input-group-label sp-flex-container">\n\t\t\t\t\t\t\t<span>General Filters</span>\n\t\t\t\t\t\t\t<span class="sp-filter-toggle sp-clickable sp-filter-toggle-minus">${icon_minus}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_sort}<span>Sort By</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-sort sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_updated}<span>Last Updated</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-timerange sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_search}<span>Search</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-keyword sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_app}<span>App</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-app sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_owner}<span>Owner</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-owner sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_status}<span>Status</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-status sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="sp-input-group">\n\t\t\t\t\t\t<div class="sp-input-group-label sp-flex-container">\n\t\t\t\t\t\t\t<span>Attribute Filters</span>\n\t\t\t\t\t\t\t<span class="sp-filter-toggle sp-clickable sp-filter-toggle-minus">${icon_minus}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_commands}<span>Commands</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-command sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_datamodels}<span>Datamodels</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-datamodel sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_fields}<span>Fields</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-field sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_functions}<span>Functions</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-function sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_indexes}<span>Indexes</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-index sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_lookups}<span>Lookups</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-lookup sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_macros}<span>Macros</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-macro sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="sp-input-group">\n\t\t\t\t\t\t<div class="sp-input-group-label sp-flex-container">\n\t\t\t\t\t\t\t<span>Correlation Serach Filters</span>\n\t\t\t\t\t\t\t<span class="sp-filter-toggle sp-clickable sp-filter-toggle-minus">${icon_minus}</span>\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_shield}<span>Correlation Search</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-correlation sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_label}<span>Security Domain</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-domain sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_severity}<span>Severity</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-severity sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_tactics}<span>MITRE ATT&CK Tactic</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-mtr-tactic sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sp-input-container">\n\t\t\t\t\t\t\t<div class="sp-input-label sp-flex-container">${icon_techniques}<span>MITRE ATT&CK Technique</span></div>\n\t\t\t\t\t\t\t<div class="sp-filter-mtr-technique sp-input"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="sp-search-container">\n\t\t\t\t<div class="sp-search-header sp-search-row sp-flex-container">\n\t\t\t\t\t<div class="sp-search-col"></div>\n\t\t\t\t\t<div class="sp-search-col sp-flex-container">${icon_searchname}<span>Title</span></div>\n\t\t\t\t\t<div class="sp-search-col sp-flex-container">${icon_app}<span>App</span></div>\n\t\t\t\t\t<div class="sp-search-col sp-flex-container">${icon_owner}<span>Owner</span></div>\n\t\t\t\t\t<div class="sp-search-col sp-flex-container">${icon_updated}<span>Updated</span></div>\n\t\t\t\t\t<div class="sp-search-col sp-flex-container">${icon_nextschedule}<span>Next Scheduled Time</span></div>\n\t\t\t\t\t<div class="sp-search-col sp-flex-container">${icon_share}<span>Sharing</span></div>\n\t\t\t\t\t<div class="sp-search-col sp-flex-container">${icon_status}<span>Status</span></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="sp-search-list">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`),new s({id:"sm_base",data:"results",preview:!0,cache:!0,search:'| inputlookup search_decomposition.csv where (title="*$keyword$*" OR description="*$keyword$*") status=$status$\n\t\t| foreach command datamodel field index macro lookup function mtr_tactic mtr_technique\n\t\t\t[eval <<FIELD>>=split(<<FIELD>>, "|")]\n\t\t| foreach command datamodel field index macro lookup function\n\t\t\t[eval <<FIELD>>=lower(<<FIELD>>)]'},{tokens:!0});var d=new s({id:"ppm_searchlist",data:"results",preview:!0,cache:!0,search:'| inputlookup search_decomposition.csv where (title="*$keyword$*" OR description="*$keyword$*") status=$status$\n\t\t| foreach command datamodel field index macro lookup function mtr_tactic mtr_technique\n\t\t\t[eval <<FIELD>>=lower(split(<<FIELD>>, "|"))]\n\t\t| fillnull command datamodel field index macro lookup function mtr_tactic mtr_technique value="N/A"\n\t\t| search field IN ($field$) app IN ($app$) owner IN ($owner$) command IN ($command$) datamodel IN ($datamodel$) index IN ($index$) macro IN ($macro$) lookup IN ($lookup$) function IN ($function$) mtr_tactic IN ($tactic$) mtr_technique IN ($technique$)\n\t\t| sort $sort$'},{tokens:!0});new n({id:"ppm_searchlist2",manager:"ppm_searchlist",data:"results",preview:!0,cache:!0,search:"| streamstats count\n\t\t| search count > 0  count <= 100 "},{tokens:!0}),c=new c({id:"sp_view",managerid:"ppm_searchlist2",el:t(".dashboard-body .sp-search-list")}).render(),l=new l({id:"sp_filter_timerange",preset:"All Time",el:t(".sp-filter-timerange")}).render(),new p({id:"sp_filter_sort",choices:[{label:"Title",value:"title"},{label:"App",value:"app"},{label:"Owner",value:"owner"},{label:"Updated",value:"updated"},{label:"Next Scheduled Time",value:"next_scheduled"},{label:"Sharing",value:"sharing"},{label:"Status",value:"status"}],default:"title",value:"$sort$",el:t(".sp-filter-sort")},{tokens:!0}).render(),new a({id:"sp_filter_keyword",default:"",value:"$keyword$",el:t(".sp-filter-keyword")},{tokens:!0}).render();new n({id:"ppm_app",managerid:"sm_base",search:"| table app | dedup app | sort app"}),o(new i({id:"sp_filter_app",choices:[{label:"All",value:"*"}],managerid:"ppm_app",labelField:"app",valueField:"app",value:"$app$",el:t(".sp-filter-app")},{tokens:!0}).render()),new n({id:"ppm_owner",managerid:"sm_base",search:"| stats count by owner | sort owner"}),o(new i({id:"sp_filter_owner",choices:[{label:"All",value:"*"}],default:"*",managerid:"ppm_owner",labelField:"owner",valueField:"owner",value:"$owner$",el:t(".sp-filter-owner")},{tokens:!0}).render());new p({id:"sp_filter_status",choices:[{label:"All",value:"*"},{label:"Enabled",value:"Enabled"},{label:"Disabled",value:"Disabled"}],default:"*",value:"$status$",el:t(".sp-filter-status")},{tokens:!0}).render();new n({id:"ppm_command",managerid:"sm_base",search:"| stats count by command | sort command"}),o(new i({id:"sp_filter_command",choices:[{label:"All",value:"*"}],default:"*",managerid:"ppm_command",valuePrefix:"command=",delimeter:" OR ",labelField:"command",valueField:"command",value:"$command$",el:t(".sp-filter-command")},{tokens:!0}).render()),new n({id:"ppm_datamodel",managerid:"sm_base",search:"| stats count by datamodel | sort datamodel"}),o(new i({id:"sp_filter_datamodel",choices:[{label:"All",value:"*"}],default:"*",managerid:"ppm_datamodel",labelField:"datamodel",valueField:"datamodel",value:"$datamodel$",el:t(".sp-filter-datamodel")},{tokens:!0}).render()),o(new i({id:"sp_filter_field",allowCustomValues:!0,choices:[{label:"All",value:"*"}],default:"*",value:"$field$",el:t(".sp-filter-field")},{tokens:!0}).render()),new n({id:"ppm_function",managerid:"sm_base",search:"| stats count by function | sort function"}),o(new i({id:"sp_filter_function",choices:[{label:"All",value:"*"}],default:"*",managerid:"ppm_function",labelField:"function",valueField:"function",value:"$function$",el:t(".sp-filter-function")},{tokens:!0}).render()),new n({id:"ppm_index",managerid:"sm_base",search:"| stats count by index | sort index"}),o(new i({id:"sp_filter_index",choices:[{label:"All",value:"*"}],default:"*",managerid:"ppm_index",labelField:"index",valueField:"index",value:"$index$",el:t(".sp-filter-index")},{tokens:!0}).render()),new n({id:"ppm_lookup",managerid:"sm_base",search:"| stats count by lookup | sort lookup"}),o(new i({id:"sp_filter_lookup",choices:[{label:"All",value:"*"}],default:"*",managerid:"ppm_lookup",labelField:"lookup",valueField:"lookup",value:"$lookup$",el:t(".sp-filter-lookup")},{tokens:!0}).render()),new n({id:"ppm_macro",managerid:"sm_base",search:"| stats count by macro | sort macro"}),o(new i({id:"sp_filter_macro",choices:[{label:"All",value:"*"}],default:"*",managerid:"ppm_macro",labelField:"macro",valueField:"macro",value:"$macro$",el:t(".sp-filter-macro")},{tokens:!0}).render());new p({id:"sp_filter_correlation",choices:[{label:"All",value:"*"},{label:"Yes",value:"yes"},{label:"No",value:"no"}],default:"*",value:"$correlation$",el:t(".sp-filter-correlation")},{tokens:!0}).render();function r(t){t.css("height","auto");let e=t.prop("scrollHeight");t.css("height",e+"px")}function o(e){e.on("change",(s=>{0==s.length||s.length>1&&"*"==s[s.length-1]?e.val("*"):s.length>1&&"*"==s[0]&&e.val(s[1]),r(t(e.el.closest(".sp-input-group")))}))}o(new i({id:"sp_filter_severity",choices:[{label:"All",value:"*"},{label:"Critical",value:"critical"},{label:"High",value:"high"},{label:"Medium",value:"medium"},{label:"Low",value:"low"},{label:"Informational",value:"informational"}],default:"*",value:"$severity$",el:t(".sp-filter-severity")},{tokens:!0}).render()),new n({id:"ppm_domain",managerid:"sm_base",search:"| stats count by security_domain | sort security_domain"}),o(new i({id:"sp_filter_domain",choices:[{label:"All",value:"*"}],default:"*",value:"$domain$",managerid:"ppm_domain",labelField:"security_domain",valueField:"security_domain",el:t(".sp-filter-domain")},{tokens:!0}).render()),new n({id:"ppm_tactic",managerid:"sm_base",search:"| stats count by mtr_tactic | sort mtr_tactic"}),o(new i({id:"sp_filter_tactic",choices:[{label:"All",value:"*"}],default:"*",managerid:"ppm_tactic",labelField:"mtr_tactic",valueField:"mtr_tactic",value:"$tactic$",el:t(".sp-filter-mtr-tactic")},{tokens:!0}).render()),new n({id:"ppm_technique",managerid:"sm_base",search:"| stats count by mtr_technique | sort mtr_technique"}),o(new i({id:"sp_filter_techniuqe",choices:[{label:"All",value:"*"}],default:"*",managerid:"ppm_technique",labelField:"mtr_technique",valueField:"mtr_technique",value:"$technique$",el:t(".sp-filter-mtr-technique")},{tokens:!0}).render()),d.on("search:done",(function(e){console.log(this.query.attributes.search);let s=this.data("results").attributes.manager.attributes.data.resultCount;t(".sp-result-count-value",$dashboard).html(s)})),t(".sp-input-group").each((function(){r(t(this))})),t(".sp-filter-toggle").on("click",(function(){t(this).closest(".sp-input-group").toggleClass("closed"),t(this).hasClass("sp-filter-toggle-minus")?(t(this).html(icon_plus),t(this).removeClass("sp-filter-toggle-minus").addClass("sp-filter-toggle-plus")):t(this).hasClass("sp-filter-toggle-plus")&&(t(this).html(icon_minus),t(this).removeClass("sp-filter-toggle-plus").addClass("sp-filter-toggle-minus"))}))}));